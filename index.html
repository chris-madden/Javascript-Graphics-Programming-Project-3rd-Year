<!DOCTYPE html>

<html>

<head>
    <meta charset="UTF-8">
    <title>Canvas</title>

    <style type="text/css">
        body {
            background-color: white;
        }
        
        canvas {
            border: 2px solid black;
        }
    </style>

</head>

<body>

  <canvas id="canvasOne"></canvas>

<script type="text/javascript">
    
    // Gets a handle to the element with id canvasOne.
    var canvas = document.getElementById("canvasOne");

    // Set the canvas up for drawing in 2D.
    var ctx = canvas.getContext("2d");

    //Resizes canvas when file opened
    function onLoad() {
        canvas.width = 600;
        canvas.height = 800;
        drawUserShip();
        console.log("Bullet Position Y " + bullet.position.y);
    }
    
    //Draws the users ship to the canvas
    function drawUserShip()
    {
        //Clear the canvas each time method is called
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        //Start path for drawing ship
        ctx.beginPath(); 
        
        //Position the top of ship will be at
        ctx.moveTo(userShipObject.shipTopPosition.x, userShipObject.shipTopPosition.y); 
        
        //Draw line to left corner of ship
        ctx.lineTo(userShipObject.shipLeftPostiton.x, userShipObject.shipLeftPostiton.y); 
        
        //Draw line to right corner of ship
        ctx.lineTo(userShipObject.shipRightPosition.x, userShipObject.shipRightPosition.y); 
        
        //Colour in the ship
        ctx.fill();
        
        //Close the path
        ctx.closePath();
    }
    
    // Bullet Object
    var bullet = {
        
        position: {
            
            x: 50,
            y: 600
            
        },
        size: {
            
            width: 4,
            height: 4
            
        },
        velocity: {
            
            y: 10
            
        }
        
    }//End bullet object
    
    //Draws the bullet
    function drawBullet(){
        
        //Start path for drawing ship
        ctx.beginPath(); 
        
        ctx.rect(bullet.position.x, bullet.position.y, bullet.size.width, bullet.size.height);
        
        ctx.fill();
        
        ctx.closePath();
        
    }
    
    //Function repeats using requestAnimationFrame which makes the bullet travel by itself after being shot
    function moveBullet(){
        
        // Collision detection for bullet with top of canvas
        if(bullet.position.y)
        {
            
            bullet.position.y -= bullet.velocity.y;
            
        }
        
        //Repeat the function
        requestAnimationFrame(moveBullet);

    }
     
    //Object for the user Ship
    var userShipObject = {
        
        shipTopPosition: {
            
            x: 300,
            y: 700
            
        },
        shipLeftPostiton: {
            
            x: 275,
            y: 725
            
        },
        shipRightPosition: {
            
            x: 325,
            y: 725
        
        },  
        acceleration: {
            
            x: 7,
            y: 0
            
        },
        moveRight: function () {
            
            //If ships right corner isn't touching the edge of the canvas and is less than or equal to the canvas width - the acceleration value
            if(userShipObject.shipRightPosition.x < canvas.width && userShipObject.shipRightPosition.x <= (canvas.width - userShipObject.acceleration.x))
            {     
                //Move the ship to the right along the x axis to the speed set in the acceleration object
                userShipObject.shipTopPosition.x += userShipObject.acceleration.x;
                userShipObject.shipLeftPostiton.x += userShipObject.acceleration.x;
                userShipObject.shipRightPosition.x += userShipObject.acceleration.x;
            }
            //If ships postion is greater than the (canvas width - acceleration distance) E.G 595 > 590. Only move the number of pixels required to reach 600 (canvas.width)
            else if(userShipObject.shipRightPosition.x > (canvas.width - userShipObject.acceleration.x))
            {
                //Move ship the pixels required to reach edge of canvas
                userShipObject.shipTopPosition.x += (canvas.width - userShipObject.shipRightPosition.x);
                userShipObject.shipLeftPostiton.x += (canvas.width - userShipObject.shipRightPosition.x);
                userShipObject.shipRightPosition.x += (canvas.width - userShipObject.shipRightPosition.x);
            }
            
        },
        moveLeft: function(){
        
            //If shipLeftPostiton.x is greater than 0 and greater than or equal to acceleration.x
            if(userShipObject.shipLeftPostiton.x > 0 && userShipObject.shipLeftPostiton.x >= userShipObject.acceleration.x)
            {
                //Move the ship to the left along the x axis to the speed set in the acceleration object
                userShipObject.shipTopPosition.x -= userShipObject.acceleration.x;
                userShipObject.shipLeftPostiton.x -= userShipObject.acceleration.x;
                userShipObject.shipRightPosition.x -= userShipObject.acceleration.x;
            }
            else if(userShipObject.shipLeftPostiton.x < userShipObject.acceleration.x)//shipLeftPostiton.x less than acceleration.x
            {
                //Move the ship to the left along the x axis to the amount of remaining pixels
                userShipObject.shipRightPosition.x -= userShipObject.shipLeftPostiton.x;
                userShipObject.shipTopPosition.x -= userShipObject.shipLeftPostiton.x;
                userShipObject.shipLeftPostiton.x -= userShipObject.shipLeftPostiton.x;  
            }
    
        }
    }//End of userShipObject

    //Initialise size of canvas
    onLoad();

    //Repeated function which takes care of the animation frames
    function step()
    {
        drawUserShip();
        drawBullet();
        requestAnimationFrame(step);
    }

    //Adding an event listener so user can use keys to move ship
    window.addEventListener("keydown", function(event) { 

        //If right arrow key is pressed
        if (event.keyCode == 39)
        {     
            //Move the ship to the right
            userShipObject.moveRight();       
            console.log("Ship left corner at " + userShipObject.shipLeftPostiton.x);
            console.log("Ship right corner at " +userShipObject.shipRightPosition.x);
            console.log("Ship top at " + userShipObject.shipTopPosition.x);
            
        }
        else if(event.keyCode == 37)//If left arrow key is pressed
        {
            userShipObject.moveLeft();
            console.log("Ship left corner at " + userShipObject.shipLeftPostiton.x);
            console.log("Ship right corner at " +userShipObject.shipRightPosition.x);
            console.log("Ship top at " + userShipObject.shipTopPosition.x);
        }
        else if(event.keyCode == 32)//If the spacebar is hit
        {
              moveBullet();
        }
     
    });//End event listener
      
    //Call the step method 
    step();

    </script>

</body>

</html>